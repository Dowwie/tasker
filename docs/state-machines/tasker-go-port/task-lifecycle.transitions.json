{
  "version": "1.0",
  "machine_id": "M1",
  "transitions": [
    {
      "id": "TR1",
      "name": "Initialize",
      "from_state": "S1",
      "to_state": "S2",
      "trigger": "init command",
      "guard": {
        "condition": "target_dir exists and is writable",
        "invariant_id": "I1",
        "negated": false
      },
      "spec_ref": {
        "quote": "state.py init <target_dir> - Initialize new decomposition",
        "location": "Workflow 1, Step 1"
      }
    },
    {
      "id": "TR2",
      "name": "LoadTasks",
      "from_state": "S2",
      "to_state": "S3",
      "trigger": "load-tasks command",
      "guard": {
        "condition": "tasks directory exists with valid task files",
        "invariant_id": "I1",
        "negated": false
      },
      "spec_ref": {
        "quote": "Load task files from tasks/ directory",
        "location": "Workflow 1, Step 2"
      }
    },
    {
      "id": "TR3",
      "name": "TaskBecomesPending",
      "from_state": "S3",
      "to_state": "S4",
      "trigger": "ready-tasks query",
      "guard": {
        "condition": "task has no unmet dependencies",
        "invariant_id": "I1",
        "negated": false
      },
      "spec_ref": {
        "quote": "Compute tasks ready for execution",
        "location": "Workflow 1, Step 3"
      }
    },
    {
      "id": "TR4",
      "name": "StartTask",
      "from_state": "S4",
      "to_state": "S5",
      "trigger": "start-task command",
      "guard": {
        "condition": "task is in pending state",
        "invariant_id": "I3",
        "negated": false
      },
      "spec_ref": {
        "quote": "Mark task as running",
        "location": "Workflow 1, Step 4"
      }
    },
    {
      "id": "TR5",
      "name": "CompleteTask",
      "from_state": "S5",
      "to_state": "S6",
      "trigger": "complete-task command",
      "guard": {
        "condition": "task is in running state",
        "invariant_id": "I3",
        "negated": false
      },
      "spec_ref": {
        "quote": "Mark task as complete with file tracking",
        "location": "Workflow 1, Postconditions"
      }
    },
    {
      "id": "TR6",
      "name": "FailTask",
      "from_state": "S5",
      "to_state": "S7",
      "trigger": "fail-task command",
      "guard": {
        "condition": "task is in running state",
        "invariant_id": "I3",
        "negated": false
      },
      "spec_ref": {
        "quote": "Mark task as failed with classification",
        "location": "Workflow 1, Failures"
      }
    },
    {
      "id": "TR7",
      "name": "RetryTask",
      "from_state": "S7",
      "to_state": "S4",
      "trigger": "retry-task command",
      "guard": {
        "condition": "task is in failed state and retryable",
        "invariant_id": "I3",
        "negated": false
      },
      "spec_ref": {
        "quote": "Reset failed task to pending",
        "location": "Workflow 1, Variants"
      }
    },
    {
      "id": "TR8",
      "name": "SkipTask",
      "from_state": "S4",
      "to_state": "S8",
      "trigger": "skip-task command",
      "guard": {
        "condition": "task is in pending state",
        "invariant_id": "I3",
        "negated": false
      },
      "spec_ref": {
        "quote": "Skip task without blocking dependents",
        "location": "Workflow 1, Variants"
      }
    },
    {
      "id": "TR9",
      "name": "RequestHalt",
      "from_state": "S5",
      "to_state": "S9",
      "trigger": "halt command",
      "guard": {
        "condition": "no critical operation in progress",
        "invariant_id": "I3",
        "negated": false
      },
      "spec_ref": {
        "quote": "Request graceful halt of execution",
        "location": "Workflow 1, Variants"
      }
    },
    {
      "id": "TR10",
      "name": "Resume",
      "from_state": "S9",
      "to_state": "S3",
      "trigger": "resume command",
      "guard": {
        "condition": "halt flag is set",
        "invariant_id": "I3",
        "negated": false
      },
      "spec_ref": {
        "quote": "Clear halt flag and resume execution",
        "location": "Workflow 1, Variants"
      }
    },
    {
      "id": "TR11",
      "name": "DetectCorruption",
      "from_state": "S2",
      "to_state": "S10",
      "trigger": "load with corrupted file",
      "guard": {
        "condition": "state file fails validation and recovery fails",
        "invariant_id": "I6",
        "negated": true
      },
      "spec_ref": {
        "quote": "If state file is corrupted, attempt auto-recovery before failing",
        "location": "Workflow 1, Failures"
      }
    },
    {
      "id": "TR12",
      "name": "RecoverState",
      "from_state": "S2",
      "to_state": "S3",
      "trigger": "auto-recovery succeeds",
      "guard": {
        "condition": "corrupted state can be recovered",
        "invariant_id": "I6",
        "negated": false
      },
      "spec_ref": {
        "quote": "attempt auto-recovery before failing",
        "location": "Workflow 1, Variants"
      }
    }
  ]
}
